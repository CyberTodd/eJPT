##### Exploiting Microsoft IIS WebDAV

IIS - Internet Information Services is an extensible web server software developed by Microsoft for use with the Windows NT family. It can be used to host both static and dynamic web pages developed in ASP.NET and PHP.

Supported executable file extensions:
- .asp
- .aspx
- .config
- .php

WebDAV - Web-based Distributed Authoring and Versioning is a set of extensions to the HTTP protocol which allow users to collaboratively edit and manage files on remote web servers. It runs on top Microsoft IIS on ports 80/ 443.

---
Tools:

- davtest - used to scan, authenticate and exploit a WebDAV server
- cadaver - supports file upload, download, on-screen display, in-place editing, namespace operations (move/ copy), and more from a WebDAV servers.

---
##### Exploit WebDAV With Metasploit

Tools:
- msfconsole
- msfvenom
- cadaver

---
##### Exploiting SMB With PsExec

- SMB runs on port 445 TCP, originally ran on top of NetBIOS using port 139.
- SAMBA is the open source Linux implementation of SMB, and allows Windows sytems to access Linux shares and devices.
- SMB Protocol utilizez 2 level of authentication:
	- User Authentication - users must provide a username and password
	- Share Authentication - users must provide a password in order to access restricted share
	- both of these authentication levels utilize a challenge response authentication system.

![[Pasted image 20230206153755.png]]
- PsExec is a lightweight telnet-replacement developed by Microsfot that allows you to execute processes on remote windows systems using any user's credentials. PsExec authentication is performed via SMB. 
	- It is very similar to RDP, but instead of controlling the remote system via GUI, commands are sent via CMD.
---
##### Exploiting Windows MS17-010 SMB Vulnerability (EternalBlue)

- EternalBlue (MS17-010/CVE-2017-0144) is a collection of Windows vulnerabilities that allow attackers to remotely execute arbitrary code and gain access to a Windows system and consequently the network that the target system is part of.
- Is one of the biggest Windows vulnerability because SMB runs on almost all Windows systems and this exploit will not only provide with access to the target system, but also will give you elevated privileged so you don't need to do a priviledged escalation. 
---
##### Exploiting RDP

- RDP uses TCP on port 3389 by default, is a proprietary GUI remote access protocol developed by Microsoft and is used to remotely connect and interact with a Windows system.
---
##### Exploiting Windows CVE-2019-0708 EDO Vulnerability (BlueKeep)

- BlueKeep is the name of a given RDP vulnerability in Windows that could potentially allow attackers to remotely execute arbitrary code and gain access to a Windows system and consequently the network that the target system is part of.
- Allows attackers to gain access to a chunk of kernel memory - this kernel is also the place where the code will be executed.
	- Kernel has elevated privileges. Executing code here will most likely cause system crushes.
- Metasploit has an auxiliary module that can be used to check if a target system is vulnerable and also it has a module to exploit it.
---
##### Exploiting WinRM

- WinRM - Windows Remote Management Protocol that runs typically on port 5985 and 5986 (HTTPS), is a Windows remote management protocol that can be used to facilitate remote access with Windows systems over HTTP(s).
- WinRM implements access control and security for communication between systems through various forms of authentication.
---

